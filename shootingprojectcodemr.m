%  _ represents superscript  
%Mooney-Rivlin
%initial guesses M gamma, rho, x - P etatheta
 %1)  0.3 0.4, 2, 5.7 0.7 -5.7820    0.6907
 %1)  0.3 0.4, 2.3, 5.7 0.9 - 5.7876    0.8211
%1)  0.3 0.4, 2.5, 5.8 1 - 5.7756    0.9089
%1)  0.3 0.4, 2.7, 5.8 1 - 5.7777    0.9973
%1)  0.3 0.4, 2.9, 5.8 1 - 5.7988    1.0862
%1)  0.3 0.4, 3, 6 1 - 5.8163 1.1308
% 1)  0.3 0.4, 3.1, 6 1 - 5.8384 1.1756
% 1)  0.3 0.4, 3.2, 5.8 1.2 - 5.8648 1.2204
% 1)  0.3 0.4, 3.3, 5.8 1.2 - 5.8953 1.2653
% 1)  0.3 0.4, 3.4, 5.9 1.3 - 5.9295 1.3103
% 1)  0.3 0.4, 3.5, 5.9 1.3 - 5.9674 1.3553
% 1)  0.3 0.4, 3.6, 6 1.4 - 6.0084 1.4005
% 1)  0.3 0.4, 3.7, 6 1.4 - 6.0526 1.4456
% 1)  0.3 0.4, 3.8, 6 1.45 - 6.0994 1.4908
% 1)  0.3 0.4, 3.9, 6 1.5 - 6.1495    1.5359
% 1)  0.3 0.4, 4, 6 1.5 -  6.2017    1.5812
% 1)  0.3 0.4, 4.1, 6.2 1.6 -  6.2562    1.6265
% 1)  0.3 0.4, 4.2, 6.2 1.65 -  6.3130    1.6719
% 1)  0.3 0.4, 4.3, 6.2 1.65 -  6.3715    1.7173
% 1)  0.3 0.4, 4.4, 6.2 1.7 -  6.4320    1.7627
% 1)  0.3 0.4, 4.5, 6.3 1.75 - 6.4944    1.8082
% 1)  0.3 0.4, 4.6, 6.3 1.8 - 6.5582    1.8538
% 1)  0.3 0.4, 4.7, 6.3 1.8 - 6.6235    1.8994
% 1)  0.3 0.4, 4.8, 6.4 1.85 -6.6238    1.8994
% 1)  0.3 0.4, 4.8, 6.4 1.85 - 6.6904    1.9450
% 1)  0.3 0.4, 4.9, 6.5 1.9 - 6.7586    1.9906
% 1)  0.3 0.4, 5, 6.5 1.95 - 6.8279    2.0363
% removed lb and ub
% 1)  0.3 0.4, 5.1, 6.7 2 - 6.8984    2.0821
% 1)  0.3 0.4, 5.2, 6.9 2 - 6.9698    2.1278
% 
% 1)  0.1 0.4, 2  , 3.9 0.7 - 4.3548    0.6648  0.5510
% 1)  0.1 0.4, 2.2, 3.9 0.7 - 4.2151    0.7407    0.5718
% 1)  0.1 0.4, 2.4, 3.8 0.8 - 4.0598    0.8166  0.5929
% 1)  0.1 0.4, 2.6, 3.6 0.9 - 3.9166    0.8931 0.6120
% 1)  0.1 0.4, 2.8, 3.5 1   - 3.7930    0.9704  0.6279
% 1)  0.1 0.4, 3  , 3.5 1.1 - 3.6895    1.0489 0.6397
% 1)  0.1 0.4, 3.2, 3.3 1.4 - 3.6044    1.1284   0.6471
% 1)  0.1 0.4, 3.4, 3.3 1.4 - 3.5354    1.2091  0.6499
% 1)  0.1 0.4, 3.6, 3.3 1.4 - 3.4805    1.2909  0.6481
% 1)  0.1 0.4, 3.8, 3.3 1.4 - 3.4378    1.3739 0.6420
% 1)  0.1 0.4, 4  , 3.5 1.5 - 3.4056    1.4579 0.6316
% 1)  0.1 0.4, 4.2, 3.5 1.5 - 3.3825    1.5428 0.6177
% 1)  0.1 0.4, 4.4, 3.5 1.5 - 3.3673    1.6285 0.6007
% 1)  0.1 0.4, 4.6, 3.5 1.5 - 3.3591    1.7151 0.5812
% 1)  0.1 0.4, 4.8, 3.5 1.5 - 3.3571    1.8023 0.5596
% 1)  0.1 0.4, 5  , 3.5 2   - 3.3604    1.8899 0.5366
% 1)  0.1 0.4, 5.2, 3.5 2   - 3.3686    1.9782 0.5125
% 1)  0.1 0.4, 5.4, 3.5 2   - 3.3811    2.0667 0.4879
% 1)  0.1 0.4, 5.6, 3.5 2   - 3.3976    2.1557 0.4630
% 1)  0.1 0.4, 5.8, 3.5 2   - 3.4174    2.2449 0.4383
% 1)  0.1 0.4, 6  , 3.5 2   - 3.4406    2.3344 0.4139

function shootingprojectcodemr 
clc
x = [4 0.7];
LB = [0 0];
UB = [ ];
%options = optimset('FunValCheck', 'on', 'MaxFunEvals', 10000, 'TolFun', 1e-14, 'TolX', 1e-6);
xx = fminsearchbnd(@projectcode,x)

function F = projectcode(x,rho)
%options = odeset('RelTol',1e-9,'AbsTol',[1e-9 1e-9 1e-9 1e-9]);
P = x(1);
rho = 2;
[theta,U,P] = ode45(@equation,[0 pi],[rho; 0; 0; x(2)]);
s = length(theta);
v = size(U,1);
F = sqrt((U(s,2))^2 + (U(s,3))^2); 
figure(1)
xlabel("\rho");ylabel("\eta");
grid on;
plot(U(:,1), U(:,3), 'linewidth', 0.5);
ans = U(end,1)
%xlabel('\rho')
%ylabel('\eta')
%title('Shooting Method using Fzero')


function dydx = equation(theta,U)
        gamma = 0.4;
        M = 0.1; %P = 7.23;
        R = 1 + (gamma* (cos(theta)));

        Sm_1 = (((U(2)^2 + U(4)^2)^2)*((U(1)^2)*(R^2))) + (3 *((gamma)^4)*(R^4));%checked
        Sm_2 = (((U(2)^2 + U(4)^2)^2)*((U(1)^2)*(R^2))) - (((gamma)^4)*(R^4));%checked
        Sm_3 = ((-3*((U(2)^2 + U(4)^2)^(-2)))*((U(1)^(-2))*(R^(-2)))) - (((gamma)^(-4))*(R^(-4)));%checked
        Sm_4 = (((U(2)^2 + U(4)^2)^(-2))*((U(1)^(-2))*(R^(-2)))) - (((gamma)^(-4))*(R^(-4)));%checked

        Vm_1 = (2*((U(2)*R) + (U(1)*gamma*sin(theta))))*((gamma^4)*(R^5));%checked
        Vm_2 = (((U(2)^2 + U(4)^2)^2)*((U(1)^2)*(R^2))) - (((gamma)^4)*(R^4));%checked
        Vm_3 = ((-2)*((U(2)*R) + (U(1)*gamma*sin(theta))))*((gamma^(-4))*(R^(-3)));%checked
        Vm_4 = (((U(2)^2 + U(4)^2)^(-2))*((U(1)^(-2))*(R^(-2)))) - (((gamma)^(-4))*(R^(-4)));%checked
        Vm_5 = (((U(2)^2 + U(4)^2))*((U(1)^4)*(gamma^2))) - (((gamma)^4)*(R^4));%checked
        Vm_6 = (((U(2)^2 + U(4)^2)^(-1))*((U(1)^(-4))*(gamma^(-2)))) - (((gamma)^(-4))*(R^(-4)));%checked

        lambda1 = 1/gamma * sqrt(U(2)^2 + U(4)^2);
        lambda2 = U(1)/R;

        V1 = (((Vm_2*U(1)*U(2)*((U(2)^2 + U(4)^2)^2)*gamma*R*sin(theta))+(Vm_5*((U(2)^2 + U(4)^2)^3)*(R^2)))*(lambda1^4))-((Vm_1*U(2)*((U(2)^2 + U(4)^2)^2))*(lambda1^4))-M*((Vm_4*U(1)*U(2)*((U(2)^2 + U(4)^2)^2)*gamma*R*sin(theta)) + (Vm_6*((U(2)^2 + U(4)^2)^3)*(R^2)))*(lambda1^8)*(lambda2^4)*(gamma^8)*(R^8) + M*(Vm_3* U(2)*((U(2)^2 + U(4)^2)^2))*(lambda1^8)*(lambda2^4)*(gamma^8)*(R^8) - 0.5* P* U(1)*U(4)*((U(2)^2 + U(4)^2)^(1.5))*(lambda1^9)*(lambda2^3)*(gamma^6)*(R^6);%checked
        V2 = ((Vm_2*U(1)*U(4)*((U(2)^2 + U(4)^2)^2)*gamma*R*sin(theta))*(lambda1^4))-((Vm_1*U(4)*((U(2)^2 + U(4)^2)^2))*(lambda1^4))-(M*((Vm_4*U(1)*U(4)*((U(2)^2 + U(4)^2)^2)*gamma*R*sin(theta)))*(lambda1^8)*(lambda2^4)*(gamma^8)*(R^8)) +(M*(Vm_3*U(4)*((U(2)^2 + U(4)^2)^2))*(lambda1^8)*(lambda2^4)*(gamma^8)*(R^8)) + (0.5*P*U(1)*U(2)*((U(2)^2 + U(4)^2)^(1.5))*(lambda1^9)*(lambda2^3)*(gamma^6)*(R^6));%checked

        S22 = ((U(1)*(R^2)*(U(2)^2 + U(4)^2)*((Sm_1*(U(2)^2)) + (Sm_2*(U(4)^2))))*(lambda1^4)) - M*(U(1)*(R^2)*(U(2)^2 + U(4)^2)*((Sm_3*(U(2)^2)) + (Sm_4*(U(4)^2))))*(lambda1^8)*(lambda2^4)*(gamma^8)*(R^8);%checked
        S24 = ((U(1)*(R^2)*(U(2)^2 + U(4)^2)*((Sm_1*U(2)*U(4)) - (Sm_2*U(2)*U(4))))*(lambda1^4)) - (M*(U(1)*(R^2)*(U(2)^2 + U(4)^2)*((Sm_3*U(2)*U(4)) - (Sm_4*U(2)*U(4))))*(lambda1^8)*(lambda2^4)*(gamma^8)*(R^8));%checked
        S42 = S24;
        S44 = ((U(1)*(R^2)*(U(2)^2 + U(4)^2)*((Sm_1*U(4)^2) + (Sm_2*U(2)^2)))*(lambda1^4)) - (M*(U(1)*(R^2)*(U(2)^2 + U(4)^2)*((Sm_3*U(4)^2) + (Sm_4*U(2)^2)))*(lambda1^8)*(lambda2^4)*(gamma^8)*(R^8));%checked

        mass = [1 0 0 0; 
                0 S22 0 S24; 
                0 0 1 0;
                0 S42 0 S44];
        
        dydx = mass\ [U(2); V1; U(4); V2];
end
end
end