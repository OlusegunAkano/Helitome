%  _ represents superscript  
%neo-Hookean
%initial guesses  gamma, rho, x - P etatheta ans
% 1)   0.6, 2  , 1.9 0.8 - 1.9039    0.8149 0.3654
% 1)   0.6, 2.2, 1.9 0.8 - 2.3099    1.1033 0.2631
% 1)   0.6, 2.4, 2.3 1.1 - 2.5025    1.4064 0.2126
% 1)   0.6, 2.6, 2.3 1.4 - 2.6774    1.7635 0.1769
% 1)   0.6, 2.8, 2.7 1.9 - 2.8880    2.2059 0.1502
% 1)   0.6, 3  , 2.9 2.6 - 3.1734    2.7782 0.1275
% 1)   0.6, 3.2, 3.5 3.5 - 3.5876    3.5560 0.1165
% 1)   0.6, 3.4, 4.3 4.7 - 4.2627    4.8235 0.0654 

% 
% 1)  0.5, 2  , 1.9 0.8 - 1.7169 0.5667 0.7902
% 1)  0.5, 2.2, 1.9 0.8 - 2.3986 0.8508 0.5349
% 1)  0.5, 2.4, 1.9 0.8 - 2.5405 1.0870 0.4358
% 1)  0.5, 2.6, 2   1   - 2.6320 1.3452 0.3605
% 1)  0.5, 2.8, 2.6 1.3 - 2.7268 1.6420 0.2969
% 1)  0.5, 3  , 2.6 1.6 - 2.8449 1.9931 0.2425
% 1)  0.5, 3.2, 2.7 1.8 - 3.0018 2.4191 0.1974
% 1)  0.5, 3.4, 2.9 2.2 - 3.2164 2.9514 0.1618
% 1)  0.5, 3.6, 3.2 3.2 - 3.5187 3.6412 0.1347
% 1)  0.5, 3.8, 3.8 4.3 - 3.9634 4.5808 0.1141
% 1)  0.5, 4  , 4.8 6   - 4.6692 5.9664 0.0964
% 
% 
% 1)   0.4, 2.2 , 2   0.8 - 2.1187 0.4664 1.2240
% 1)   0.4, 2.4 , 2   1  -  2.5794 0.7242 0.9457
% 1)   0.4, 2.6 , 2   1  -  2.6502 0.9317 0.8236
% 1)   0.4, 2.8 , 2   1  -  2.6917 1.1520 0.7216
% 1)   0.4, 3  ,  2   1  -  2.7366 1.3958 0.6279
% 1)   0.4, 3.6   2.7 1.8 - 2.9726 2.3487 0.3784
% 1)   0.4, 3.8   2.7 2.2 - 3.1029 2.7772 0.3063
% 1)   0.4, 4  ,  2.9 2.5 - 3.2722 3.2908 0.2419
% 1)   0.4, 4.2 , 3.1 2.9 - 3.4957 3.9216 0.1869
% 1)   0.4, 4.4 , 3.2 3.5 - 3.7991 4.7222 0.1439
% 1)   0.4, 4.6 , 4   5  -  4.2309 5.7880 0.1134
% 
% 
% 
% 1)   0.3, 5  , 3   3  -   3.3222 3.9002 0.4505
% 1)   0.3, 4.8, 3   3  -   3.1876 3.3911 0.5411
% 1)   0.3, 4.6, 3   3  -   3.0774 2.9494 0.6359
% 1)   0.3, 4.4, 3   2.7  - 2.9874 2.5618 0.7348
% 1)   0.3, 4.2, 3   2.5  - 2.9143 2.2185 0.8370
% 1)   0.3, 4  , 3   2.2  - 2.8556 1.9114 0.9426
% 1)   0.3, 3.8, 2.9 1.9  - 2.8100 1.6350 1.0510
% 1)   0.3, 3.6, 2.9 1.6  - 2.7759 1.3842 1.1625
% 1)   0.3, 3.4, 2.8 1.4  - 2.7524 1.1549 1.2772
% 1)   0.3, 3.2, 2.7 1.2  - 2.7373 0.9434 1.3959
% 1)   0.3, 3  , 2.8 1   -  2.7259 0.7458 1.5206
% 1)   0.3, 2.8, 2.8 0.8  - 2.6943 0.5534 1.6653
% 1)   0.3, 2.6, 2.7 0.6  - 2.4390 0.3461 1.8791
% 1)   0.3, 2.4, 2.5 0.4  - 2.4400 0.3189 1.7303
% 1)   0.3, 2.2, 2.5 0.4  - 2.5059 0.3122 1.5332
% 1)   0.3, 2  , 2.5 0.4  - 2.6466 0.3150 1.3082


%  fminsearch 3.9 5.1 4.2354    4.6797

function shootingprojectcodeneo 
clc
x = [6 9]; %initial guess at I
LB = [0 0];
UB = [];
options = optimset('Display','iter','MaxFunEvals', 10000);
xx = fminsearchbnd(@projectcodeneo,x)


function F= projectcodeneo(x)
% options = odeset('RelTol',1e-9,'AbsTol',[1e-9 1e-9 1e-9 1e-9]);
% options = odeset('stats','off','Mass',@massmat,'RelTol',1e-6,'AbsTol',1e-9);
P = x(1);
rho = 4.2;
[theta,U,P] = ode45(@equationneo,[0 pi],[rho 0 0 x(2)]);
s = length(theta);
F = sqrt((U(s,2))^2 + (U(s,3))^2);
ans = U(end,1)
figure(8)
plot(U(:,1),U(:,3))

%xlabel('\rho')
%ylabel('\eta')
%title('Shooting Method using Fzero')

function dydx = equationneo(theta,U)
    gamma = 0.5;
    %P = 0.926;
    R = 1 + (gamma* (cos(theta)));

    Sn_1 = (((U(2).^2 + U(4).^2)^2)*((U(1).^2)*(R.^2))) + (3 *(gamma^4)*(R.^4));
    Sn_2 = (((U(2).^2 + U(4).^2)^2)*((U(1).^2)*(R.^2))) - ((gamma^4)*(R.^4));

    Vn_1 = (2*((U(2)*R) + (U(1)*gamma*sin(theta))))*((gamma^4)*(R.^5));
    Vn_2 = (((U(2).^2 + U(4).^2)^2)*((U(1).^2)*(R.^2))) - ((gamma^4)*(R.^4));
    Vn_3 = (((U(2).^2 + U(4).^2)^2)*((U(1)^4)*(gamma^2))) - ((gamma^4)*(R.^4));

    lambda1 = 1/gamma * sqrt(U(2).^2 + U(4).^2);
    lambda2 = U(1)/R;

    V1 = (((Vn_2*U(1)*U(2)*((U(2).^2 + U(4).^2)^2)*gamma*R*sin(theta))+(Vn_3*((U(2).^2 + U(4).^2)^3)*(R.^2)))*(lambda1^6)*(lambda2^2)*(gamma^4)*(R.^4))-(Vn_1*U(2)*((U(2).^2 + U(4).^2)^2)*(lambda1^6)*(lambda2^2)*(gamma^4)*(R.^4)) - (0.5*P*U(1)*U(4)*((U(2).^2 + U(4).^2)^(1.5))*(lambda1^11)*(lambda2^5)*(gamma^10)*(R^10));
    V2 = (((Vn_2*U(1)*U(2)*((U(4).^2 + U(4).^2)^2)*gamma*R*sin(theta)))*(lambda1^6)*(lambda2^2)*(gamma^4)*(R.^4))-(Vn_1*U(4)*((U(2).^2 + U(4).^2)^2)*(lambda1^6)*(lambda2^2)*(gamma^4)*(R.^4)) + (0.5*P*U(1)*U(2)*((U(2).^2 + U(4).^2)^(1.5))*(lambda1^11)*(lambda2^5)*(gamma^10)*(R^10));

    S22 = ((U(1)*(R.^2)*(U(2).^2 + U(4).^2)*((Sn_1*U(2).^2) + (Sn_2*U(4).^2)))*(lambda1^6)*(lambda2^2)*(gamma^4)*(R.^4));
    S24 = ((U(1)*(R.^2)*(U(2).^2 + U(4).^2)*((Sn_1*U(2)*U(4)) - (Sn_2*U(2)*U(4))))*(lambda1^6)*(lambda2^2)*(gamma^4)*(R.^4));
    S42 = S24; 
    S44 = ((U(1)*(R.^2)*(U(2).^2 + U(4).^2)*((Sn_1*U(4).^2) + (Sn_2*U(2).^2)))*(lambda1^6)*(lambda2^2)*(gamma^4)*(R.^4));

            mass = [1 0 0 0; 
            0 S22 0 S24; 
            0 0 1 0;
            0 S42 0 S44];

    dydx = mass\ [U(2); V1; U(4); V2];
end
end
end